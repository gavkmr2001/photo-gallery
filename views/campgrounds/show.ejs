<%- include("../partials/header") %>


<!-- =========================sidebar=============== -->
<div class="container">
	<div class="row">
		<div class="col-md-3">
			<p class="lead">YelpCamp</p>
			<div class="list-group">
				<li class="list-group-item active">Info 1</li>
				<li class="list-group-item">Info 2</li>
				<li class="list-group-item">Info 3</li>
			</div>
		</div>
		
	<!-- ===================================================== -->
		
		
	<!-- =========================campground====================== -->
		<div class="col-md-9">
			<div class="card">
				<img src="<%= campground.image %>" class="card-img-top">
				<div class="card-body">
					<div class="caption">
						<h4 class="float-right"><%= campground.price %>/night</h4>
						<h4 id="name"><a>	<%= campground.name %></a></h4>
						<p><%= campground.description %></p>
						<p> 
							 <em>Submitted By <%= campground.author.username %></em>
						</p>
						<!-- check app.js for currentuser -->
<!-- when user not logged in then currentUser is not defined so gives an error so need this --> 
						<% if(currentUser && campground.author.id.equals(currentUser._id)){ %>
							<a class="btn btn-warning" href="/campgrounds/<%= campground._id %>/edit">
								Edit
							</a>
							<form class="delete-form" action="/campgrounds/<%= campground._id %>?_method=DELETE" method="POST">
								 <button class="btn btn-danger">Delete</button>
							</form>
						<% } %>
					</div>
				</div>
			</div>
	<!-- ===============comment==================== -->
			<div class="card">			
				<div class="card-body">
					<div class="float-right">
						<a class="btn btn-success" href="/campgrounds/<%= campground._id %>/comments/new">Add New comment</a>
					</div>
					<br>
					<hr style="margin: 30px">
<!-- loop through all the comments and show them in paragraph -->
					<% campground.comments.forEach(function(comment){ %>
						<div class="row">
							<div class="col-md-12">
								<strong><%= comment.author.username %></strong>
								<span class="float-right">10 days ago</span>
								<p>
									 <%= comment.text %>
								</p>
	<!-- check app.js -- res.locals.currentUser= req.user; -->
								<% if(currentUser && comment.author.id.equals(currentUser._id)){ %>
									<a class="btn btn-xs btn-warning" 
										 href="/campgrounds/<%=campground._id %>/comments/<%= comment._id%>/edit"> Edit </a>
	<!-- delete comment button cannot be just an <a>tag becoz we need a POST request. -->
									<form class="delete-form" action="/campgrounds/<%=campground._id %>/comments/<%= comment._id%>?_method=DELETE" method="POST">
										<input type="submit" class="btn btn-xs btn-danger" value="Delete">
									</form>
								<% } %>
							</div>
						</div>
					<% }) %>					
				</div>
			</div>
			
			
		</div>
	</div>	
</div>

<%- include("../partials/footer") %>


<!-- methodoverride used to send delete request ?_method=DELETE" method="POST"> -->